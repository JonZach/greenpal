<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-responsive.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/fullcalendar.css">
    <link href="css/smoothness/jquery-ui-1.10.2.custom.css" rel="stylesheet">
    <script src="js/jquery-1.9.1.min.js"></script>
    <script src="js/jquery-ui-1.10.2.custom.min.js"></script>
    <script src="js/fullcalendar.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    
  </head>
  <body>

    <!-- top navigation bar -->

    <div class="navbar navbar-static-top">
      <div class="navbar-inner">
        <div id="main-nav"></div>
      </div>
    </div>

    <!-- content -->
    <!-- Start Accordion -->
    <div class="accordion" id="accordion2">
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle btn-primary btn-large" type="button" role="button" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne" id="homeownerOption"><img src="images/home.png"> HOMEOWNERS</a>
        </div>
        <div id="collapseOne" class="accordion-body collapse">
          <div class="accordion-inner" id="homeExpand">
            <!-- Homeowner Section to enter Vendor Code -->
            <div class="container" id="homeowner">
              <div class="hero-unit">
                <div class="row">
                  <div class="span4">
                    <h2>Pick Your Vendor!</h2>
                  </div>
                  <div class="span6">
                    <h3> Enter a specific Vendor Code to schedule with the GreenPal of your choice.</h3>
                    <a href="#findVendor" type="button" role="button" class="btn btn-primary btn-large" id="pickVendor" data-target="#findVendor" data-toggle="modal">Schedule Today <b>&rarr;</b></a>
                  </div>
                </div>
              </div>
              <!--  findVendor modal  -->
              <div id="findVendor" class="modal hide fade">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h3><img src="images/gplogo.jpg"> Search Vendor</h3>
                    <p>Enter your Vendor Code below to schedule your GreenPal today!</p>
                </div>
                <div class="modal-body">
                  <form id="modal_form" class="form-horizontal" style="margin-top: 20px;">
                    <div class="control-group">
                      <label class="control-label" for="code">Vendor Code</label>
                      <div class="controls">
                        <input type="text" class="code_inputs" id="code" name="code" placeholder="PeachtreeHendrix">
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="service_date">Service Date</label>
                      <div class="controls">
                        <input type="text" class="code_inputs datepicker" id="datepick" name="datepick" placeholder="click icon to select date">
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="home_address">Home Address</label>
                      <div class="controls">
                        <input type="text" class="code_inputs" id="homeAddress" name="homeAddress" placeholder="Enter Street and Zip Code">
                      </div>
                    </div>
                  </form>
                </div>
                  <div class="modal-footer">  
                    <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>       
                    <button id="findVendorCode" class="submit btn btn-primary" onclick="return false">Submit</button>    
                  </div>      
              </div> <!-- end createVendor modal -->                     
            </div> <!-- END Homeowner container -->
          </div>
        </div>
      </div>
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle btn-primary btn-large" type="button" role="button" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo" id="vendorOption"><img src="images/leaf.png"> GREENPAL Vendors</a>
        </div>
        <div id="collapseTwo" class="accordion-body collapse">
          <div class="accordion-inner" id="vendorExpand">
            <!-- Vendor Section to enter business info -->
            <div class="container" id="vendor">
              <div class="hero-unit">
                <div class="row">
                  <div class="span4">
                    <h2>Become A <img src="images/gplogo.jpg"> Vendor Today</h2>
                  </div>
                  <div class="span6">
                    <h3>Fill out your basic info and we do the rest!</h3>
                    <a href="#createVendor" type="button" role="button" class="btn btn-primary btn-large" id="vendorSignup" data-target="#createVendor" data-toggle="modal">Sign Up Today <b>&rarr;</b></a>
                  </div>
                </div>
              </div>
              <!-- createVendor modal -->
              <div id="createVendor" class="modal hide fade">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h3><img src="images/gplogo.jpg"> Vendor Application</h3>
                </div>
                <div class="modal-body">
                  <form id="modal_form" class="form-horizontal" style="margin-top: 20px;">
                    <div class="control-group">
                      <label class="control-label" for="business_name">Business Name</label>
                      <div class="controls">
                        <input type="text" class="vendor_inputs" id="businessName" name="businessName" placeholder="Peachtree Lawncare">
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="first_name">First Name</label>
                      <div class="controls">
                        <input type="text" class="vendor_inputs" id="firstName" name="firstName" placeholder="John" >
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="last_name">Last Name</label>
                      <div class="controls">
                        <input type="text" class="vendor_inputs" id="lastName" name="lastName" placeholder="Doe">
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="phone">Phone Number</label>
                      <div class="controls">
                        <input type="text" id="phoneNumber" class="vendor_inputs" name="phone" placeholder="1234567890">
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="email">Email</label>
                      <div class="controls">
                        <input type="text" class="vendor_inputs" id="email" name="email" placeholder="you@email.com">
                      </div>
                    </div>
                  </form>
                </div>
                  <div class="modal-footer">  
                    <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>       
                    <button id="addVendor" class="submit btn btn-primary" onclick="return false">Submit</button>    
                  </div>      
              </div> <!-- end createVendor modal -->      
            </div>  <!-- end Vendor container -->   
          </div>
        </div>
      </div>
    </div> <!-- END Accordion -->

    <!--  ourVendors Table  -->
    <div class="span6">
      <table id="mytable" class="table">
        <thead>
          <tr id="vendorHeadFill"><h4 id="vendorTableHeading">Our Vendors</h4></tr>
          <tr><th>Business Name</th><th>Vendor Code</th><th>Contact Person</th></tr>
        </thead>
        <tbody id="ourVendors">
        </tbody>
      </table>
    </div> <!--   END ourVendors  -->

    <!--  apptSchedule calendar   -->
    <div class="span6">
      <div class="calendar" id="apptSchedule"></div>
    </div>

  <script>
    $(document).ready(function(){

      var allVendors = new Array ();

     /* $.ajax({
          type: "DELETE",
          url: "backliftapp/allJobs/2a636a36-4362-48b3-aa53-f2962dd56b3b", 
          success: function(data) { 
             console.log("Deleted!");
          } //end success function
      }); //end ajax DELETE */

      //populateCalendar();
      getVendorInfo();

      function getVendorInfo(){
        $.ajax({
          url: "/backliftapp/vendor",
          type: "GET",
          success: function(data) {
            console.log(data);
            $.each(data, function(){
              $('<tr><td>' + this.businessName + '</td><td>' + this.id + '</td><td>' + this.firstName + '</td></tr>').appendTo('#ourVendors');

            }) // END .each
          } // END success
        }) // END ajax GET
      }; // END getVendorInfo

      getAllJobs();

      function getAllJobs(){
        $.ajax({
          url: "/backliftapp/allJobs",
          type: "GET",
          success: function(data) {
            console.log(data);
          }
        })
      };


      
      //===============================================
      //    START #findVendorCode Click Event
      //===============================================
      
      
      $('#findVendorCode').click(function(){
        var newJob = {
          title: $('#code').val(),
          start: $('#datepick').val(),
          homeAddress: $('#homeAddress').val(),
        }; //END newJob variable

        $.ajax({
          url: "/backliftapp/allJobs",
          type: "POST",
          dataType: "json",
          data: newJob,
          success: function (data){
            console.log(data);
          }// END success
        }); //END Ajax
        $('#findVendor').modal('hide');
          addToCalendar();
          clearForm();
      }); // END #addVendor Click

      function addToCalendar(){
        var jobDate = $('#datepick').val();
        if (jobDate === $('.fc-widget-content').data('date')){
          alert("You have a new appt!");
        }
        else {
          //alert(jobDate);
          alert($('.fc-widget-content').data('date'));
        }
      };
      //===============================================
      //    START #addVendor Click Event
      //===============================================

      $('#addVendor').click(function(){
        var vendor = {
          id: $('#businessName').val() + $('#lastName').val(),
          businessName: $('#businessName').val(),
          firstName: $('#firstName').val(),
          lastName: $('#lastName').val(),
          phoneNumber: $('#phoneNumber').val(),
          email: $('#email').val(),

        }; // END vendor variable

        $.ajax({
          url: "/backliftapp/vendor",
          type: "POST",
          dataType: "json",
          data: vendor,
          success: function (data){
            allVendors.push(data);
            console.log(data);

          } //end success

        }) //end ajax Post

        $('#createVendor').modal('hide');
        //alert('Your Vendor Code is' + ' ' + $('#businessName').val() + $('#lastName').val());
          $('<tr><td>' + $('#businessName').val() + '</td><td>' + $('#businessName').val() + $('#lastName').val() + '</td><td>' + $('#firstName').val() + '</td></tr>').appendTo('#ourVendors');
        clearForm();
        
      }) // END #addVendor Click

      //==============================================
      //    START Datepicker PlugIn
      //==============================================


      $(function() {
        $( ".datepicker" ).datepicker({
          showOn: "button",
          buttonImage: "images/calendar.png",
          buttonImageOnly: true
        });
        //$.datepicker.formatDate("yy-mm-dd", new Date(2007,1 - 1,14));
      }); // END Datepicker



      //==============================================
      //  START fullCalendar plugin
      //==============================================
      $('.calendar').fullCalendar({
        // put your options and callbacks here
      }) //END fullCalendar
      
      function clearForm(){
        $('.vendor_inputs').each(function(){
          $(this).val('');
        });
        $('.code_inputs').each(function(){
          $(this).val('');
        });
      }; //end clearForm

    }); //end doc.ready

  </script>
  </body>
</html>